# CRUD Microservice
## Overview
The CRUD microservice is a headless Python microservice that provides Create, Read, Update, and Delete functionality for other programs through a file-based JSON communication pipe. 
The microservice will:
* Manage resources that are stored in JSON files (i.e data.json)
* Supports create, update, and delete operations
* Runs as a standalone proccess
* Doesn't expose any UI
* Doesn't allow for other programs to call functions directly

# Architecture
* Language: Python 3.12.2
* JSON Library: Built-in json module
* IPC method: Single control file, json, in /requests and responses/ directory
* Process Model: Runs its own process, continuously monitors for new requests
* Team Setup: Will support multiple programs in Python or C++

# Environment Variables
## Required
* CRUD_DATA_DIR
  - Must be set
  - Must point to a directory that exists
  - All input/output files (data.json, request/response files) have to be inside the working directory

# Communication Protocol
## Request Format
Requests must be valid JSON written to a request files in the requests/ directory:
~~~python
{
  "request_id": "string",           
  "user_id": "string",              
  "resource_type": "string",        
  "operation": "create|update|delete",
  "resource_data": {                
      "field1": "value1",
      "field2": "value2"
  },
  "resource_id": "string (optional for create, required for update/delete)"
}
~~~

## Operation Requirments:
* Create: resource_data, note: resource_id is optional, UUID is autogenerated if missing
* Update: resource_id/resource_data, note: updates an existing resource
* Delete: resouce_id, note: marks resource as deleted (is_deleted = True)

# Response Format
## Responses are written to responses/:
~~~python
{
  "request_id": "string",           
  "status": "success|fail",        
  "message": "string",              
  "code": 200|201|400|404|500, 
  "data": {                         
      "resource_id": "string",
      "user_id": "string",
      "resource_type": "string",
      "resource_data": {
          "field1": "value1",
          "field2": "value2"
      },
      "is_deleted": false
  } | null
}
~~~

## Standard Response Codes:
* 201: "Resource created successfully"
* 200: "Resource updated"
* 404: "Resource not found"
* 500: "Error creating resource"

## Suppoorted Operations
### Create: 
* Input: operation = "create" + resource_data
* Action: Generates a unique resource_id, or UUID if not provided, appends the resource to data.json
* Response: status = "success", code = 201, data = created resource object

### Update:
* Input: operation = "update" + resource_id + resource_data
* Action: Finds resource by resource_id and updates fields
* Response: status = "success", code = 200, data = updated resource object
* Error: Resource not found → status = "fail", code = 404, data = null

### Delete:
* Input: operation = "delete" + resource_id
* Action: Sets is_deleted = True for the resource in data.json
* Response: status = "success", code = 200, data = deleted resource object
* Error: Resource not found → status = "fail", code = 404, data = null

# Error Model
## All responses follow this schema:
~~~python
{
  "status": "fail",
  "message": "string",
  "code": <int>,
  "data": null
}
~~~

## Common Error Codes:
* 500, fail, Any unexpected exception during create_resource()
* 500, fail, Any unexpected exception during delete_resource()
* 404, fail, delete_resource called for a resource_id that doesn't exist

# Running the Microservice
* Linux/WSL: python3 crud_service.py
* Windows (Powershell): python crud_service.py

## Note:
* The microservice runs continuously, polling the requests/ folder for new request files.
* Responses are written automatically to the responses/ folder
* Make sure the requests/ and responses/ directories exist inside CRUD_DATA_DIR. If they don’t exist, the microservice will create them automatically

# ULM Sequence Diagram

Client Program
     |
     |  write request JSON
     v
requests/request_*.json
     |
     |  CRUD-MS polls file
     v
CRUD Microservice
     |
     |  process CRUD operation
     |  write response JSON
     v
responses/response_*.json
     |
     |  client reads response
     v
Client Program

<img width="542" height="287" alt="image" src="https://github.com/user-attachments/assets/438316d5-b1a5-4812-bc83-d3b6e21ee9b5" />


# Authors
Banks
CW
